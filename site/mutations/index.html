<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Mutations - The DGS Framework</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <link href="../stylesheets/extra.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">The DGS Framework</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../tutorial/" class="nav-link">Getting Started</a>
                            </li>
                            <li class="navitem">
                                <a href="../query-execution-testing/" class="nav-link">Testing</a>
                            </li>
                            <li class="navitem">
                                <a href="../data-loaders/" class="nav-link">Async Data Fetching</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">Mutations</a>
                            </li>
                            <li class="navitem">
                                <a href="../generating-code-from-schema/" class="nav-link">Code Generation</a>
                            </li>
                            <li class="navitem">
                                <a href="../java-client/" class="nav-link">Java GraphQL Client</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Advanced <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../advanced/custom-datafetcher-context/" class="dropdown-item">Data Fetching Context</a>
</li>
                                    
<li>
    <a href="../advanced/customizing/" class="dropdown-item">Custom Extensions</a>
</li>
                                    
<li>
    <a href="../advanced/error-handling/" class="dropdown-item">Error Handling</a>
</li>
                                    
<li>
    <a href="../advanced/file-uploads/" class="dropdown-item">File Uploads</a>
</li>
                                    
<li>
    <a href="../advanced/subscriptions/" class="dropdown-item">Subscriptions</a>
</li>
                                    
<li>
    <a href="../advanced/type-resolvers-for-abstract-types/" class="dropdown-item">Type Resolvers for Abstract Types</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../data-loaders/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../generating-code-from-schema/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="/edit/mutations.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="2"><a href="#input-types" class="nav-link">Input Types</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#input-arguments-as-data-fetchter-method-parameters" class="nav-link">Input arguments as data fetchter method parameters</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#kotlin-data-types" class="nav-link">Kotlin data types</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p>The DGS framework supports Mutations with the same constructs as data fetchers, using<!-- http://go/pv http://go/use --> the <code>@DgsData</code> annotation.
The following is a simple example of a mutation:</p>
<pre><code class="language-graphql">type Mutation {
    addRating(title: String, stars: Int):Rating
}

type Rating {
    avgStars: Float
}
</code></pre>
<pre><code class="language-java">@DgsComponent
public class RatingMutation {
    @DgsData(parentType = &quot;Mutation&quot;, field = &quot;addRating&quot;)
    public Rating addRating(DataFetchingEnvironment dataFetchingEnvironment) {
        int stars = dataFetchingEnvironment.getArgument(&quot;stars&quot;);

        if(stars &lt; 1) {
            throw new IllegalArgumentException(&quot;Stars must be 1-5&quot;);
        }

        String title = dataFetchingEnvironment.getArgument(&quot;title&quot;);
        System.out.println(&quot;Rated &quot; + title + &quot; with &quot; + stars + &quot; stars&quot;) ;

        return new Rating(stars);
    }
}
</code></pre>
<p>Note that the code above retrieves the input data for the Mutation by calling the <code>DataFetchingEnvironment.getArgument</code> method, just as data fetchers do for their arguments.</p>
<h2 id="input-types">Input Types</h2>
<p>In the example above the input was two standard scalar types.
You can also use complex types, and you should define these as <code>input</code> types in your schema.
An <code>input</code> type is almost the same as a <code>type</code> in [GraphQL], but with <a href="https://graphql.org/learn/schema/#input-types">some extra rules</a>.</p>
<p>According to the GraphQL specification an input type should<!-- http://go/should --> always be passed<!-- http://go/pv --> to the data fetcher as a <code>Map</code>.
This means the <code>DataFetchingEnvironment.getArgument</code> for an input type is a <code>Map</code>, and not the Java/Kotlin representation that you might have.
The framework has a convenience mechanism around this, which will be discussed next.
Let's first look at an example that uses DataFetchingEnvironment directly.</p>
<pre><code class="language-graphql">type Mutation {
    addRating(input: RatingInput):Rating
}

input RatingInput {
    title: String,
    stars: Int
}

type Rating {
    avgStars: Float
}
</code></pre>
<pre><code class="language-java">@DgsComponent
public class RatingMutation {
    @DgsData(parentType = &quot;Mutation&quot;, field = &quot;addRating&quot;)
    public Rating addRating(DataFetchingEnvironment dataFetchingEnvironment) {

        Map&lt;String,Object&gt; input = dataFetchingEnvironment.getArgument(&quot;input&quot;);
        RatingInput ratingInput = new ObjectMapper().convertValue(input, RatingInput.class);

        System.out.println(&quot;Rated &quot; + ratingInput.getTitle() + &quot; with &quot; + ratingInput.getStars() + &quot; stars&quot;) ;

        return new Rating(ratingInput.getStars());
    }
}

class RatingInput {
    private String title;
    private int stars;

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public int getStars() {
        return stars;
    }

    public void setStars(int stars) {
        this.stars = stars;
    }
}
</code></pre>
<h2 id="input-arguments-as-data-fetchter-method-parameters">Input arguments as data fetchter method parameters</h2>
<p>The framework makes it easier to get input arguments.
You can specify arguments as method parameters of a data fetcher.</p>
<pre><code class="language-java">@DgsComponent
public class RatingMutation {
    @DgsData(parentType = &quot;Mutation&quot;, field = &quot;addRating&quot;)
    public Rating addRating(@InputArgument(&quot;input&quot;) RatingInput ratingInput) {
        //No need for custom parsing anymore!
        System.out.println(&quot;Rated &quot; + ratingInput.getTitle() + &quot; with &quot; + ratingInput.getStars() + &quot; stars&quot;) ;

        return new Rating(ratingInput.getStars());
    }
}
</code></pre>
<p>The <code>@InputArgument</code> annotation is important to specify the name of the input argument, because arguments can be specified in any order.
If no annotation is present, the framework tries to use the parameter name, but this is only possible if the code is compiled with <a href="https://docs.oracle.com/javase/tutorial/reflect/member/methodparameterreflection.html">specific compiler settings</a>.
Input type parameters can be combined with a <code>DataFetchingEnvironment</code> parameter.</p>
<pre><code class="language-java">@DgsComponent
public class RatingMutation {
    @DgsData(parentType = &quot;Mutation&quot;, field = &quot;addRating&quot;)
    public Rating addRating(@InputArgument(&quot;input&quot;) RatingInput ratingInput, DataFetchingEnvironment dfe) {
        //No need for custom parsing anymore!
        System.out.println(&quot;Rated &quot; + ratingInput.getTitle() + &quot; with &quot; + ratingInput.getStars() + &quot; stars&quot;) ;
        System.out.println(&quot;DataFetchingEnvironment: &quot; + dfe.getArgument(ratingInput));

        return new Rating(ratingInput.getStars());
    }
}
</code></pre>
<h2 id="kotlin-data-types">Kotlin data types</h2>
<p>In Kotlin, you can use Data Classes to represent input types.
However, make sure its<!-- "its" is ambiguous here --> fields are either <code>var</code> or add a <code>@JsonProperty</code> to each constructor argument, and use <code>jacksonObjectMapper()</code> to create a Kotlin-compatible Jackson mapper.</p>
<pre><code class="language-kotlin">data class RatingInput(var title: String, var stars: Int)
</code></pre>
<p>--8&lt;-- "docs/reference_links"</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../js/mermaid.min.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
